# سیستم ارزیابی انطباق مقررات CAELUS

*Compliance Assessment Engine Leveraging Unified Semantics*

## معرفی

CAELUS یک سیستم هوشمند برای بررسی انطباق طراحی‌های مهندسی با مقررات و استانداردهای صنعتی است. این سیستم با استفاده از ترکیبی از مدل‌های زبانی بزرگ (LLM)، گراف دانش و روش‌های پردازش زبان طبیعی پیشرفته، می‌تواند دقت و کارایی فرآیند بررسی انطباق را بهبود بخشد.

## معماری سیستم

سیستم CAELUS از چهار بخش اصلی تشکیل شده است:

1. **پردازش داده‌ها (Data Ingestion)**: استخراج متن از مقررات و تقسیم آن به واحدهای معنایی (semantic units)
2. **گراف دانش (Knowledge Graph)**: ساخت گراف روابط بین بخش‌های مختلف مقررات برای درک عمیق‌تر ارتباطات آنها
3. **بررسی انطباق (Compliance Checker)**: استفاده از LLM برای تطبیق هوشمند طراحی با مقررات
4. **تولید گزارش (Report Generator)**: ارائه گزارش‌های دقیق و جامع از میزان انطباق طراحی با مقررات

## ویژگی‌های اصلی

- **تشخیص انطباق مبتنی بر LLM**: به جای روش‌های مبتنی بر قاعده (rule-based)، از مدل‌های زبانی پیشرفته برای درک متن استفاده می‌کند
- **Fine-tuning مدل‌ها**: امکان آموزش مدل‌های LLM با داده‌های تخصصی برای افزایش دقت
- **گراف دانش**: استخراج و نمایش روابط بین بخش‌های مختلف مقررات 
- **گزارش به فرمت Markdown**: تولید گزارش‌های خوانا و جامع با جزئیات کامل

## نصب و راه‌اندازی

### پیش‌نیازها

- Python 3.8 یا بالاتر
- PyTorch
- Transformers
- Sentence-Transformers
- NetworkX
- Matplotlib
- Pandas

### نصب وابستگی‌ها

```bash
pip install -r requirements.txt
```

### ساختار دایرکتوری

```
caelus_compliance_project/
├── data/                      # دایرکتوری داده‌ها
│   ├── raw_pdfs/              # فایل‌های PDF مقررات اصلی
│   ├── processed_text/        # متون استخراج شده از PDFها
│   ├── design_specs/          # مشخصات طراحی
│   └── fine_tuning_datasets/  # داده‌های آموزشی برای fine-tuning
├── models/                    # مدل‌های ذخیره شده
│   ├── fine_tuned_llm/        # مدل‌های fine-tuned
│   └── embeddings/            # embedding‌های از پیش محاسبه شده
├── output/                    # خروجی‌های سیستم
│   └── charts/                # نمودارها و گراف‌های دانش
├── src/                       # کد منبع
│   ├── data_ingestion.py      # پردازش و استخراج داده‌ها
│   ├── knowledge_graph.py     # ساخت و مدیریت گراف دانش
│   ├── compliance_checker.py  # بررسی انطباق
│   ├── report_generator.py    # تولید گزارش‌ها
│   ├── llm_finetuning.py      # fine-tuning مدل‌های LLM
│   └── main.py                # مدیریت کلی فرآیند
├── notebooks/                 # Jupyter notebook‌ها برای نمایش
└── templates/                 # قالب‌های گزارش
```

## استفاده از سیستم

### اجرای آزمایشی ساده

برای اجرای یک آزمایش ساده روی داده‌های نمونه:

```bash
python src/simple_tester.py --skip-kg
```

پارامتر `--skip-kg` برای رد کردن مرحله ساخت گراف دانش استفاده می‌شود که به منابع پردازشی زیادی نیاز دارد.

### اجرای کامل سیستم

```bash
python src/main.py --design path/to/design_file.txt --report-format markdown
```

### پارامترهای قابل تنظیم

- `--design`: مسیر فایل مشخصات طراحی
- `--report-format`: فرمت گزارش (markdown, html, pdf, excel)
- `--skip-ingestion`: رد کردن مرحله پردازش داده‌ها
- `--skip-knowledge-graph`: رد کردن مرحله ساخت گراف دانش
- `--run-fine-tuning`: اجرای مرحله fine-tuning مدل
- `--regulations`: تعداد مقررات مرتبط برای بررسی

## تغییرات نسبت به نسخه قبلی

1. **روش تشخیص انطباق**: به جای روش مبتنی بر قاعده (rule-based)، از مدل‌های LLM استفاده می‌شود
2. **گراف دانش**: امکان ساخت گراف دانش از مقررات با استفاده از مدل fine-tuned اضافه شده است
3. **نوع گزارش‌دهی**: گزارش‌ها به جای JSON، به فرمت Markdown تولید می‌شوند
4. **Fine-tuning مدل**: قابلیت fine-tuning مدل‌های LLM برای افزایش دقت تشخیص اضافه شده است
5. **تقسیم‌بندی متن**: بهبود روش تقسیم متن به واحدهای معنایی با استخراج ارتباطات بین آنها

## رفع اشکال و خطاهای معمول

- **خطای کمبود حافظه GPU**: استفاده از پارامتر `--skip-kg` برای رد کردن مرحله ساخت گراف دانش
- **خطای بارگذاری مدل LLM**: سیستم به طور خودکار به حالت rule-based برمی‌گردد
- **تفاوت نوع داده در محاسبه شباهت**: اصلاح شده با تبدیل هر دو بردار به float32

## توسعه آینده

1. بهبود فرآیند fine-tuning با داده‌های بیشتر و تخصصی‌تر
2. توسعه واسط کاربری گرافیکی برای سهولت استفاده
3. اضافه کردن پشتیبانی از زبان‌های بیشتر
4. بهبود مقیاس‌پذیری سیستم برای حجم بالای داده‌ها

## مشارکت‌کنندگان

این پروژه توسط تیم Parscoders توسعه داده شده است.

## مجوز

